import{a as be}from"./chunk-BF44GFKR.js";import{a as Se}from"./chunk-ZSRRXJJU.js";import{a as ve,b as Ce}from"./chunk-OSH75MHU.js";import{a as ie}from"./chunk-NJXUTP4C.js";import{a as he}from"./chunk-R3D3CR7Y.js";import{A as a,B as u,C as pe,D as de,E as b,F as C,G as h,I as g,J as I,K as ue,N as V,O as F,P,Q as W,R as fe,Z as G,aa as te,ca as f,d as B,da as v,ea as _,f as ee,fa as y,g as E,ga as N,h as k,ha as T,i as m,ia as z,j as c,ja as U,k as S,ka as j,l as O,la as q,m as se,n as M,o as D,q as n,r,s as x,sa as H,t as ce,u as me,ua as J,v as L,va as R,w as p,wa as w,x as d}from"./chunk-B6J72TLZ.js";var K=class l{constructor(t,e,i,o){this.routesService=t;this.clanService=e;this.authService=i;this.errorService=o}ngOnDestroy(){this.subscriptions.unsubscribe()}full_nameInput="";abbreviationInput="";subscriptions=new _;toMenu(){this.routesService.navigate.toMenu()}registerClan(t,e){this.subscriptions.add=this.clanService.registerClan(t,e).subscribe({next:i=>{i.token&&this.authService.updateToken(i.token)},complete:()=>{window.alert(`Cl\xE3 ${t} (${e}) registrado com sucesso`),this.full_nameInput="",this.abbreviationInput=""},error:i=>{this.errorService.handler(i)}})}static \u0275fac=function(e){return new(e||l)(c(f),c(w),c(v),c(y))};static \u0275cmp=S({type:l,selectors:[["app-clan-new"]],standalone:!1,decls:18,vars:2,consts:[[1,"d-flex","flex-column","align-items-center","justify-content-center"],[1,"mb-3"],[1,"bg-dark","bg-opacity-75","border","border-3","border-light","rounded-3","mb-3","p-3","text-center"],[1,"d-flex","flex-column","align-items-center","justify-content-center","mb-3"],["for","full_name",1,"fs-4","mb-2"],["maxlength","50","type","text","name","full_name","id","full_name","placeholder","Ex: Shields",1,"text-center","rounded",3,"ngModelChange","ngModel"],["for","abbreviation",1,"fs-4","mb-2"],["maxlength","6","type","text","name","abbreviation","id","abbreviation","placeholder","Ex: SHLDS",1,"text-center","rounded",3,"ngModelChange","ngModel"],[1,"d-flex","align-items-center","justify-content-between","my-3"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-success",3,"click"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"h1",1),a(2,"Registrar cl\xE3"),r(),n(3,"div",2)(4,"form")(5,"div",3)(6,"label",4),a(7,"Nome do cl\xE3"),r(),n(8,"input",5),h("ngModelChange",function(s){return C(i.full_nameInput,s)||(i.full_nameInput=s),s}),r()(),n(9,"div",3)(10,"label",6),a(11,"Sigla"),r(),n(12,"input",7),h("ngModelChange",function(s){return C(i.abbreviationInput,s)||(i.abbreviationInput=s),s}),r()(),n(13,"div",8)(14,"button",9),p("click",function(){return i.toMenu()}),a(15,"Voltar"),r(),n(16,"button",10),p("click",function(){return i.registerClan(i.full_nameInput,i.abbreviationInput)}),a(17,"Registrar"),r()()()()()),e&2&&(m(8),b("ngModel",i.full_nameInput),m(4),b("ngModel",i.abbreviationInput))},dependencies:[q,N,T,z,H,j,U],encapsulation:2})};function Ie(l,t){if(l&1){let e=L();n(0,"tr")(1,"td")(2,"button",7),p("click",function(){E(e);let o=d().$implicit,s=d();return k(s.toClan(o.id))}),a(3),g(4,"titlecase"),r()(),n(5,"td")(6,"a"),a(7),g(8,"uppercase"),r()(),n(9,"td")(10,"button",8),p("click",function(){E(e);let o=d().$implicit,s=d();return k(s.editClan(o.id))}),x(11,"i",9),r()(),n(12,"td")(13,"button",10),p("click",function(){E(e);let o=d().$implicit,s=d();return k(s.deleteClan(o.id,o.full_name))}),x(14,"i",11),r()()()}if(l&2){let e=d().$implicit;m(3),u(I(4,2,e.full_name)),m(4),u(I(8,4,e.abbreviation))}}function Ee(l,t){if(l&1&&(ce(0),M(1,Ie,15,6,"tr",6),me()),l&2){let e=t.$implicit;m(),D("ngIf",e.full_name!="shields")}}var Q=class l{constructor(t,e,i,o){this.routesService=t;this.clanService=e;this.authService=i;this.errorService=o}ngOnInit(){this.refreshData()}ngOnDestroy(){this.subscriptions.unsubscribe()}clans=[];subscriptions=new _;getAllClans(){this.subscriptions.add=this.clanService.getAllClans().subscribe({next:t=>{this.clans=t.data,t.token&&this.authService.updateToken(t.token)},error:t=>{this.errorService.handler(t)}})}toClan(t){this.routesService.navigate.toClan(t)}editClan(t){this.routesService.navigate.toClanEdit(t)}deleteClan(t,e){window.confirm(`Deseja remover o cl\xE3 ${e.toUpperCase()} e todos seus swordplayers?`)&&(this.subscriptions.add=this.clanService.deleteClan(t).subscribe({next:o=>{o.token&&this.authService.updateToken(o.token)},complete:()=>window.alert("Cl\xE3 removido"),error:o=>{this.errorService.handler(o)}}))}refreshData(){this.getAllClans()}static \u0275fac=function(e){return new(e||l)(c(f),c(w),c(v),c(y))};static \u0275cmp=S({type:l,selectors:[["app-clan-list"]],standalone:!1,decls:14,vars:1,consts:[[1,"d-flex","justify-content-around","mb-3"],[3,"refreshData"],[1,"table","table-striped","table-bordered","text-center"],[1,"fs-4"],["colspan","2",1,"fs-4"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"btn","btn-link",3,"click"],[1,"btn","btn-primary",3,"click"],[1,"bi","bi-pencil-square"],[1,"btn","btn-outline-danger",3,"click"],[1,"bi","bi-trash-fill"]],template:function(e,i){e&1&&(n(0,"div",0),x(1,"app-button-back-to-menu"),n(2,"app-button-refresh-data",1),p("refreshData",function(){return i.refreshData()}),r()(),n(3,"table",2)(4,"thead")(5,"tr")(6,"th",3),a(7,"Cl\xE3"),r(),n(8,"th",3),a(9,"Sigla"),r(),n(10,"th",4),a(11,"A\xE7\xF5es"),r()()(),n(12,"tbody"),M(13,Ee,2,1,"ng-container",5),r()()),e&2&&(m(13),D("ngForOf",i.clans))},dependencies:[V,F,he,J,W,P],encapsulation:2})};var X=class l{constructor(t,e,i,o,s){this.clanService=t;this.route=e;this.routeService=i;this.authService=o;this.errorService=s}subscriptions=new _;idClan="";clan;ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnInit(){this.idClan=this.route.snapshot.params.id,console.log(this.idClan),this.getClanById(this.idClan)}getClanById(t){this.subscriptions.add=this.clanService.getClanById(t).subscribe({next:e=>{console.log(e.data),e.token&&this.authService.updateToken(e.token),this.clan=e.data},error:e=>{this.errorService.handler(e)}})}toClanList(){this.routeService.navigate.toClanList()}updateClan(){if(!this.clan.full_name)return window.alert("Insiram um nome");if(!this.clan.abbreviation)return window.alert("Insiram uma abrevia\xE7\xE3o");this.subscriptions.add=this.clanService.updateClanById(this.clan).subscribe({next:t=>{t.token&&this.authService.updateToken(t.token)},complete:()=>{window.alert("Cl\xE3 atualizado com sucesso"),this.toClanList()},error:t=>{this.errorService.handler(t)}})}static \u0275fac=function(e){return new(e||l)(c(w),c(G),c(f),c(v),c(y))};static \u0275cmp=S({type:l,selectors:[["app-clan-edit"]],standalone:!1,decls:18,vars:2,consts:[[1,"d-flex","flex-column","align-items-center","justify-content-center"],[1,"mb-3"],[1,"bg-dark","bg-opacity-75","border","border-3","border-light","rounded-3","mb-3","p-3","text-center"],[1,"d-flex","flex-column","align-items-center","justify-content-center","mb-3"],["for","full_name",1,"fs-4","mb-2"],["type","text","name","full_name","id","full_name","placeholder","Ex: Shields",1,"text-center","rounded",3,"ngModelChange","ngModel"],["for","abbreviation",1,"fs-4","mb-2"],["maxlength","6","type","text","name","abbreviation","id","abbreviation","placeholder","Ex: SHLDS",1,"text-center","rounded",3,"ngModelChange","ngModel"],[1,"d-flex","align-items-center","justify-content-between","mb-3"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-primary",3,"click"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"h1",1),a(2,"Editar cl\xE3"),r(),n(3,"div",2)(4,"form")(5,"div",3)(6,"label",4),a(7,"Nome do cl\xE3"),r(),n(8,"input",5),h("ngModelChange",function(s){return C(i.clan.full_name,s)||(i.clan.full_name=s),s}),r()(),n(9,"div",3)(10,"label",6),a(11,"Sigla"),r(),n(12,"input",7),h("ngModelChange",function(s){return C(i.clan.abbreviation,s)||(i.clan.abbreviation=s),s}),r()(),n(13,"div",8)(14,"button",9),p("click",function(){return i.toClanList()}),a(15,"Voltar"),r(),n(16,"button",10),p("click",function(){return i.updateClan()}),a(17,"Atualizar"),r()()()()()),e&2&&(m(8),b("ngModel",i.clan.full_name),m(4),b("ngModel",i.clan.abbreviation))},dependencies:[q,N,T,z,H,j,U],encapsulation:2})};var Y=class l{transform(t,e){let i=new Set;for(let o of t)(o.nickname.includes(e)||o.full_name.includes(e))&&i.add(o);return[...i]}static \u0275fac=function(e){return new(e||l)};static \u0275pipe=se({name:"findSwordplayerInClan",type:l,pure:!0,standalone:!1})};function De(l,t){l&1&&x(0,"i",21)}function Ne(l,t){if(l&1){let e=L();n(0,"tr")(1,"td"),M(2,De,1,0,"i",19),n(3,"button",20),p("click",function(){let o=E(e).$implicit,s=d();return k(s.toSwordplayer(o.id))}),a(4),g(5,"titlecase"),r()(),n(6,"td"),a(7),r(),n(8,"td"),a(9),r(),n(10,"td"),a(11),r()()}if(l&2){let e=t.$implicit;m(2),D("ngIf",!e.is_enabled),m(2),u(I(5,5,e.nickname)),m(3),u(e.stats.combatsWon),m(2),u(e.stats.combatsDone),m(2),pe("",(e.stats.combatsWon/e.stats.combatsDone*100||0).toFixed(2),"%")}}var Z=class l{constructor(t,e,i,o,s,je,Ae,Re){this.routeService=t;this.route=e;this.authService=i;this.clanService=o;this.swpService=s;this.combatService=je;this.errorService=Ae;this.statsService=Re}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnInit(){this.idClan=this.route.snapshot.params.id,this.getClan(this.idClan)}subscriptions=new _;idClan;findSwpValue="";clan;clanMap={};swordplayers=[];swpMap={};combats=[];getClan(t){this.subscriptions.add=this.clanService.getClanById(t).subscribe({next:e=>{this.clan=e.data,e.token&&this.authService.updateToken(e.token)},complete:()=>{this.clanMap=this.clanService.mapClans([this.clan]),this.getSwordplayersByClan(t)},error:e=>{this.errorService.handler(e)}})}getSwordplayersByClan(t){this.subscriptions.add=this.swpService.getSwordplayersByClan(t).subscribe({next:e=>{this.swordplayers=e.data,e.token&&this.authService.updateToken(e.token)},complete:()=>{this.swpMap=this.swpService.mapSwordplayers(this.swordplayers),this.getCombatsByClan(t)},error:e=>{this.errorService.handler(e)}})}getCombatsByClan(t){this.subscriptions.add=this.combatService.getCombatsByClanId(t).subscribe({next:e=>{this.combats=e.data,e.token&&this.authService.updateToken(e.token)},complete:()=>{this.swordplayers=this.statsService.insertStatsInSwordplayers(this.swordplayers,this.combats,this.swpMap),this.swordplayers=this.statsService.rankSwordplayers(this.swordplayers),this.clan=this.statsService.insertStatsInClans([this.clan],this.swordplayers,this.clanMap)[0]},error:e=>{this.errorService.handler(e)}})}toSwordplayer(t){this.routeService.navigate.toSwordplayer(t)}refreshData(){this.getSwordplayersByClan(this.idClan)}static \u0275fac=function(e){return new(e||l)(c(f),c(G),c(v),c(w),c(ve),c(Se),c(y),c(be))};static \u0275cmp=S({type:l,selectors:[["app-clan"]],standalone:!1,decls:45,vars:14,consts:[[1,"border","rounded","bg-dark","bg-opacity-75"],[1,"text-center","border-bottom","rounded-top","p-2","m-0","text-center"],[1,"container","text-center"],[1,"row"],[1,"col","rounded-start","bg-dark","bg-opacity-75"],[1,"pt-3"],[1,"p-2"],[1,"col","border-start","border-end","bg-dark","bg-opacity-75"],[1,"col","rounded-end","bg-dark","bg-opacity-75"],[1,"d-flex","justify-content-end","my-2"],["type","text","placeholder","Pesquisar swordplayer",1,"form-control","me-3","mb-2","text-center",3,"ngModelChange","ngModel"],[3,"refreshData"],[1,"text-center","border","border-bottom-0","rounded-top","p-2","m-0","bg-opacity-75","bg-dark"],[1,"table","table-striped","table-bordered","text-center","align-middle"],[1,"align-middle"],["rowspan","2",1,"fs-4"],["colspan","2",1,"fs-4"],[1,"fs-5"],[4,"ngFor","ngForOf"],["class","bi bi-exclamation-triangle-fill","style","color: yellow;",4,"ngIf"],[1,"btn","btn-link",3,"click"],[1,"bi","bi-exclamation-triangle-fill",2,"color","yellow"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"h1",1),a(2),g(3,"titlecase"),g(4,"uppercase"),r(),n(5,"div",2)(6,"div",3)(7,"div",4)(8,"h5",5),a(9,"Swordplayers Inscritos"),r(),n(10,"h1",6),a(11),r()(),n(12,"div",7)(13,"h5",5),a(14,"Pontos do cl\xE3"),r(),n(15,"h1",6),a(16),r()(),n(17,"div",8)(18,"h5",5),a(19,"Combates realizados"),r(),n(20,"h1",6),a(21),r()()()()(),x(22,"hr"),n(23,"div",9)(24,"input",10),h("ngModelChange",function(s){return C(i.findSwpValue,s)||(i.findSwpValue=s),s}),r(),n(25,"app-button-refresh-data",11),p("refreshData",function(){return i.refreshData()}),r()(),n(26,"h2",12),a(27,"Ranking de Swordplayers"),r(),n(28,"table",13)(29,"thead")(30,"tr",14)(31,"th",15),a(32,"Swordplayer"),r(),n(33,"th",16),a(34,"Combates"),r(),n(35,"th",15),a(36,"Taxa de vit\xF3ria"),r()(),n(37,"tr")(38,"th",17),a(39,"Ganhos"),r(),n(40,"th",17),a(41,"Realizados"),r()()(),n(42,"tbody"),M(43,Ne,12,7,"tr",18),g(44,"findSwordplayerInClan"),r()()),e&2&&(m(2),de("",I(3,7,i.clan.full_name)," - ",I(4,9,i.clan.abbreviation),""),m(9),u(i.clan.stats.swordplayersCount),m(5),u(i.clan.stats.roundsScored),m(5),u(i.clan.stats.combatsDone),m(3),b("ngModel",i.findSwpValue),m(19),D("ngForOf",ue(44,11,i.swordplayers,i.findSwpValue)))},dependencies:[V,F,N,T,j,J,W,P,Y],encapsulation:2})};var _e=(l,t)=>{let e=ee(v),i=ee(f),o=e.isLeader(),s=e.isAdmin();return console.log("leader",o),console.log("admin",s),o||s?!0:(i.navigate.toLogin(),!1)};var Te=[{path:"new",component:K,canActivate:[R,ie]},{path:"list",component:Q,canActivate:[R,Ce]},{path:"edit/:id",component:X,canActivate:[R,ie]},{path:":id",component:Z,canActivate:[R,_e]}],$=class l{static \u0275fac=function(e){return new(e||l)};static \u0275mod=O({type:l});static \u0275inj=B({imports:[te.forChild(Te),te]})};var ye=class l{static \u0275fac=function(e){return new(e||l)};static \u0275mod=O({type:l});static \u0275inj=B({imports:[fe,$]})};export{ye as ClanModule};
